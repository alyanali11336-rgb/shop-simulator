<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shop Simulator - Balanced Physics</title>
    <style>
        body {
            margin: 0; overflow: hidden; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            height: 100vh; background: #1a1a1a; font-family: 'Courier New', monospace;
        }

        #game-container {
            width: 85vw; height: 70vh; background: #2c3e50;
            position: relative; display: flex; flex-direction: column;
            justify-content: flex-end; align-items: center;
            border: 5px solid #5d4037;
        }

        /* Balanced Elements */
        .floor {
            position: absolute; bottom: 0; width: 100%; height: 30%;
            background: #5d4037; border-top: 8px solid #4a332a; z-index: 1;
        }

        .counter {
            position: absolute; bottom: 25%; width: 380px; height: 100px;
            background: #8b4513; border: 5px solid #5d4037; z-index: 10;
        }

        #player-sprite {
            position: absolute; bottom: 33%; width: 220px; 
            left: 50%; transform: translateX(-50%);
            z-index: 5; image-rendering: pixelated;
        }

        #customer-sprite {
            position: absolute; bottom: 18%; left: -300px; 
            width: 200px; z-index: 20; transition: left 1.5s linear;
            image-rendering: pixelated;
        }

        /* Trash: Only Leaves */
        .trash {
            position: absolute; width: 30px; height: 30px; 
            font-size: 25px; cursor: pointer; z-index: 15;
        }

        /* UI Panel */
        #ui-panel {
            width: 100%; height: 140px; background: #e1b382;
            border-top: 5px solid #5d4037; display: flex;
            justify-content: center; align-items: center; gap: 15px;
        }
        .stat-box { background: #5d4037; color: #f1c40f; padding: 10px; border-radius: 5px; font-weight: bold; }
        .game-btn { padding: 12px 18px; font-weight: bold; cursor: pointer; border: none; border-radius: 10px; color: white; }

        #clean-warning {
            position: absolute; top: 10px; background: #e74c3c; color: white;
            padding: 5px 20px; border-radius: 5px; display: none; z-index: 100;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="clean-warning">‚ö†Ô∏è SHOP DIRTY!</div>
    <div class="floor"></div>
    <img src="player.png" id="player-sprite">
    <div class="counter"></div>
    <img src="ladycustomar.png" id="customer-sprite">
    <button id="bill-btn" class="game-btn" style="position:absolute; bottom:42%; left:50%; transform:translateX(-50%); background:#f1c40f; color:black; display:none; z-index:150;" onclick="processBill()">SELL üßæ</button>
</div>

<div id="ui-panel">
    <div class="stat-box">üí∞ $<span id="cash">200</span></div>
    <div class="stat-box">üçÉ DIRT: <span id="dirt-count">0</span></div>
    <button class="game-btn" style="background: #27ae60;" onclick="buyApple()">BUY STOCK ($20)</button>
    <button id="hire-btn" class="game-btn" style="background: #3498db;" onclick="hireCleaner()">HIRE CLEANER ($150)</button>
    <div style="font-size:12px; color:#5d4037;">Arrow Keys ‚¨ÖÔ∏è ‚û°Ô∏è to Move</div>
</div>

<script>
    let cash = 200, dirt = 0, isWaiting = false, hasCleaner = false;
    let playerPos = 50;

    // Movement
    window.addEventListener('keydown', (e) => {
        const player = document.getElementById('player-sprite');
        if (e.key === 'ArrowLeft' && playerPos > 30) playerPos -= 3;
        if (e.key === 'ArrowRight' && playerPos < 70) playerPos += 3;
        player.style.left = playerPos + "%";
    });

    // Cleaner Hire
    function hireCleaner() {
        if (cash >= 150 && !hasCleaner) {
            cash -= 150;
            hasCleaner = true;
            document.getElementById('hire-btn').innerText = "CLEANER ACTIVE ‚úÖ";
            document.getElementById('hire-btn').style.opacity = "0.7";
            updateUI();
            // Cleaner logic: removes dirt every 3 seconds
            setInterval(() => {
                let allTrash = document.querySelectorAll('.trash');
                if (allTrash.length > 0) {
                    allTrash[0].remove();
                    dirt--;
                    updateUI();
                }
            }, 3000);
        }
    }

    function spawnCustomer() {
        if (isWaiting || dirt > 6) return;
        isWaiting = true;
        const cust = document.getElementById('customer-sprite');
        cust.style.left = "40%"; 
        
        // Leaves fall
        setTimeout(() => {
            if (Math.random() > 0.4) createLeaf();
            document.getElementById('bill-btn').style.display = "block";
        }, 1500);
    }

    function createLeaf() {
        dirt++;
        updateUI();
        const leaf = document.createElement('div');
        leaf.className = 'trash';
        leaf.innerText = 'üçÉ';
        leaf.style.left = (Math.random() * 50 + 25) + "%";
        leaf.style.bottom = "5%";
        leaf.onclick = function() { this.remove(); dirt--; updateUI(); };
        document.getElementById('game-container').appendChild(leaf);
        if (dirt > 4) document.getElementById('clean-warning').style.display = 'block';
    }

    function processBill() {
        cash += 50;
        updateUI();
        document.getElementById('bill-btn').style.display = "none";
        customerLeave();
    }

    function customerLeave() {
        const cust = document.getElementById('customer-sprite');
        cust.style.left = "110%";
        setTimeout(() => { 
            cust.style.transition="none"; cust.style.left="-300px"; 
            setTimeout(()=> {cust.style.transition="left 1.5s linear"; isWaiting=false;}, 50); 
        }, 1500);
    }

    function updateUI() {
        document.getElementById('cash').innerText = cash;
        document.getElementById('dirt-count').innerText = dirt;
        if (dirt <= 4) document.getElementById('clean-warning').style.display = 'none';
    }

    setInterval(spawnCustomer, 6000);
</script>
</body>
</html>
