<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shop Sim Pro - Fixed</title>
    <style>
        :root { --ui-panel: #3e2723; --gold: #f1c40f; }
        body { margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; background: #1a1a1a; overflow: hidden; font-family: 'Segoe UI', sans-serif; }

        /* Top Header for Stats */
        #top-stats {
            display: grid; grid-template-columns: repeat(4, 1fr);
            background: var(--ui-panel); padding: 10px; gap: 5px;
            border-bottom: 4px solid var(--gold); z-index: 100;
        }
        .stat-item { color: var(--gold); text-align: center; font-size: 0.8rem; font-weight: bold; border-right: 1px solid #5d4037; }

        /* Game Stage Area */
        #game-view {
            flex: 1; position: relative; 
            background: linear-gradient(#2c3e50 65%, #4a332d 65%); /* Perfect Floor Line */
        }

        /* Gravity Fixed Assets */
        #counter-img { position: absolute; bottom: 25%; left: 50%; transform: translateX(-50%); width: 220px; z-index: 15; }
        .shelf { position: absolute; width: 140px; z-index: 5; }
        #shelf-1 { top: 25%; left: 5%; }
        #shelf-2 { top: 25%; right: 5%; }

        /* Characters */
        #player { position: absolute; bottom: 33%; left: 50%; transform: translateX(-50%); width: 100px; z-index: 10; }
        #customer { position: absolute; bottom: 8%; left: -150px; width: 130px; z-index: 20; transition: left 1.5s linear; }
        #cleaner { position: absolute; bottom: 8%; width: 90px; z-index: 18; display: none; }

        /* Notification */
        #collect-money { 
            position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%);
            background: #f39c12; color: white; padding: 15px 30px; border-radius: 50px;
            font-weight: bold; display: none; z-index: 200; cursor: pointer; border: 3px solid white;
        }

        /* Bottom Controls */
        #controls { height: 15vh; background: #e1b382; display: flex; padding: 10px; gap: 10px; border-top: 5px solid #3e2723; }
        .btn { flex: 1; border: none; border-radius: 10px; font-weight: bold; font-size: 1rem; cursor: pointer; color: white; box-shadow: 0 4px 0 rgba(0,0,0,0.2); }
        #refill-btn { background: #27ae60; }
        #hire-btn { background: #2980b9; }
    </style>
</head>
<body>

<div id="top-stats">
    <div class="stat-item">CASH<br><span id="cash">$200</span></div>
    <div class="stat-item">LVL<br><span id="lvl">1</span></div>
    <div class="stat-item">STOCK<br><span id="stk">0/50</span></div>
    <div class="stat-item">XP<br><span id="xp">0%</span></div>
</div>

<div id="game-view">
    <img src="shelf.png" class="shelf" id="shelf-1"> 
    <img src="shelf.png" class="shelf" id="shelf-2"> <img src="player.png" id="player"> 
    <img src="counter.png" id="counter-img"> <img src="man_idle.png" id="customer"> 
    <img src="cleaner_idle.png" id="cleaner">

    <div id="collect-money" onclick="doSale()">COLLECT MONEY ðŸ’°</div>
</div>

<div id="controls">
    <button class="btn" id="refill-btn" onclick="refill()">REFILL STOCK ($50)</button>
    <button class="btn" id="hire-btn" onclick="hire()">HIRE CLEANER ($150)</button>
</div>

<script>
    let money = 200, level = 1, stock = 0, xp = 0, busy = false;
    let currentCust = "";

    function refill() {
        if (money >= 50) {
            money -= 50; stock = Math.min(stock + 25, 50);
            updateUI();
        }
    }

    function spawn() {
        if (busy) return;
        busy = true;
        const c = document.getElementById('customer');
        const types = ["man", "old_lady", "police"]; // From GitHub
        currentCust = types[Math.floor(Math.random() * types.length)];
        
        c.src = `${currentCust}_walk.png`;
        c.style.left = "42%";

        setTimeout(() => {
            c.src = `${currentCust}_idle.png`;
            if (stock > 0) document.getElementById('collect-money').style.display = 'block';
            else setTimeout(leave, 1500);
        }, 1500);
    }

    function doSale() {
        let reward = (currentCust === "police") ? 100 : 50;
        money += reward; stock--; xp += 20;
        document.getElementById('collect-money').style.display = 'none';
        if (xp >= 100) { xp = 0; level++; }
        updateUI();
        leave();
    }

    function leave() {
        const c = document.getElementById('customer');
        c.src = `${currentCust}_walk.png`;
        c.style.left = "110%";
        setTimeout(() => {
            c.style.transition = "none"; c.style.left = "-150px";
            setTimeout(() => { c.style.transition = "left 1.5s linear"; busy = false; }, 100);
        }, 1500);
    }

    function hire() {
        if (money >= 150) {
            money -= 150;
            const cl = document.getElementById('cleaner');
            cl.style.display = 'block';
            cl.src = "cleaner_walk_right.png"; //
            cl.style.left = "80%";
            updateUI();
        }
    }

    function updateUI() {
        document.getElementById('cash').innerText = `$${money}`;
        document.getElementById('lvl').innerText = level;
        document.getElementById('stk').innerText = `${stock}/50`;
        document.getElementById('xp').innerText = `${xp}%`;
    }

    setInterval(spawn, 5000);
</script>
</body>
</html>
