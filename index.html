<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shop Simulator - Locked Borders</title>
    <style>
        body { 
            background: #111; margin: 0; display: flex; justify-content: center; 
            align-items: center; height: 100vh; overflow: hidden;
            font-family: 'Courier New', monospace; 
        }
        
        #game-window {
            position: relative; width: 800px; height: 800px;
            background: #222 url('background.png') no-repeat center;
            background-size: 100% 100%; border: 10px solid #333;
            /* Isse koi bhi sprite image se bahar nahi dikhega */
            overflow: hidden; 
        }

        .sprite { position: absolute; image-rendering: pixelated; }

        /* --- 2 SHELVES ATTACHED TO GROUND --- */
        .shelf { width: 170px; bottom: 385px; z-index: 1; }
        #s1 { left: 100px; } 
        #s2 { left: 530px; } 

        /* --- PLAYER & COUNTER --- */
        #player { width: 190px; bottom: 395px; left: 305px; z-index: 5; }
        #counter { width: 320px; bottom: 250px; left: 240px; z-index: 10; }

        /* --- CUSTOMER (Grounded and Big) --- */
        #customer { 
            width: 240px; bottom: 30px; 
            left: -260px; /* Start position inside hidden area */
            z-index: 20; transition: all 1.2s ease-in-out; 
        }

        /* Status Text (Finding Item) */
        #finding-text {
            position: absolute; width: 180px; text-align: center;
            color: #0f0; font-weight: bold; font-size: 20px;
            background: rgba(0,0,0,0.8); padding: 5px; border: 2px solid #0f0;
            border-radius: 8px; display: none; z-index: 30;
        }

        /* UI HUD */
        #hud {
            position: absolute; top: 15px; width: 100%;
            display: flex; justify-content: space-around; z-index: 100;
        }
        .stats { background: rgba(0,0,0,0.9); color: #fff; padding: 8px 15px; border: 2px solid #444; border-radius: 5px; font-size: 20px; }

        #controls {
            position: absolute; bottom: 30px; width: 100%;
            display: flex; justify-content: center; gap: 10px; z-index: 100;
        }

        button { padding: 12px 25px; cursor: pointer; border: none; font-weight: bold; border-radius: 5px; color: white; font-size: 16px; transition: 0.2s; }
        .btn-sale { background: #27ae60; box-shadow: 0 4px #1e8449; }
        .btn-upgrade { background: #2980b9; box-shadow: 0 4px #1b4f72; }
        .btn-refill { background: #e67e22; box-shadow: 0 4px #a05817; }
        button:active { transform: translateY(2px); box-shadow: none; }
        button:disabled { background: #555; cursor: not-allowed; opacity: 0.6; }
    </style>
</head>
<body>

<div id="game-window">
    <div id="hud">
        <div class="stats">CASH: $<span id="bal">0</span></div>
        <div class="stats">STOCK: <span id="stock">5</span>/5</div>
    </div>

    <div id="finding-text">Found it!</div>

    <img src="shelf_full.png" id="s1" class="sprite shelf">
    <img src="shelf_full.png" id="s2" class="sprite shelf">

    <img src="player (2).png" id="player" class="sprite">
    <img src="counter.png" id="counter" class="sprite">
    <img src="customer.png" id="customer" class="sprite">

    <div id="controls">
        <button id="saleBtn" class="btn-sale" onclick="startSale()">SALE</button>
        <button id="refillBtn" class="btn-refill" onclick="refill()" style="display:none">REFILL ($50)</button>
        <button class="btn-upgrade" onclick="levelUp()">UPGRADE ($200)</button>
    </div>
</div>

<script>
    let cash = 0;
    let stock = 5;
    let level = 1;
    const items = ["MILK", "BREAD", "SODA", "EGGS"];

    function startSale() {
        if (stock <= 0) return;
        
        const cust = document.getElementById('customer');
        const text = document.getElementById('finding-text');
        const saleBtn = document.getElementById('saleBtn');

        saleBtn.disabled = true;
        
        // Walk inside the screen area only
        cust.style.left = "280px"; 

        setTimeout(() => {
            const randomItem = items[Math.floor(Math.random() * items.length)];
            text.innerText = "WANT: " + randomItem;
            text.style.display = "block";
            text.style.left = "310px";
            text.style.bottom = "280px";

            setTimeout(() => {
                let profit = 20 + (level * 10);
                cash += profit;
                stock--;
                
                document.getElementById('bal').innerText = cash;
                document.getElementById('stock').innerText = stock;
                text.style.display = "none";

                if (stock <= 0) {
                    document.getElementById('s1').src = 'shelf_empty.png';
                    document.getElementById('s2').src = 'shelf_empty.png';
                    document.getElementById('saleBtn').style.display = "none";
                    document.getElementById('refillBtn').style.display = "block";
                }

                // Walks out of view but stays within overflow:hidden
                cust.style.left = "850px"; 
                setTimeout(() => {
                    cust.style.transition = "none";
                    cust.style.left = "-260px";
                    setTimeout(() => { 
                        cust.style.transition = "all 1.2s ease-in-out"; 
                        if (stock > 0) saleBtn.disabled = false;
                    }, 50);
                }, 1200);
            }, 1500);
        }, 1200);
    }

    function refill() {
        if (cash >= 50) {
            cash -= 50;
            stock = 5;
            document.getElementById('bal').innerText = cash;
            document.getElementById('stock').innerText = stock;
            document.getElementById('s1').src = 'shelf_full.png';
            document.getElementById('s2').src = 'shelf_full.png';
            document.getElementById('saleBtn').style.display = "block";
            document.getElementById('saleBtn').disabled = false;
            document.getElementById('refillBtn').style.display = "none";
        }
    }

    function levelUp() {
        if (cash >= 200) {
            cash -= 200;
            level++;
            document.getElementById('bal').innerText = cash;
            alert("Upgrade Successful!");
        }
    }
</script>

</body>
</html>
