<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shop Simulator - Cleaner Edition</title>
    <style>
        body {
            margin: 0; overflow: hidden; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            height: 100vh; background: #1a1a1a; font-family: 'Courier New', monospace;
        }

        #game-container {
            width: 85vw; height: 70vh; background: #2c3e50;
            position: relative; display: flex; flex-direction: column;
            justify-content: flex-end; align-items: center;
            border: 5px solid #5d4037; overflow: hidden;
        }

        /* Shelves */
        .shelf-container {
            position: absolute; top: 10%; width: 90%;
            display: flex; justify-content: space-around; z-index: 2;
        }
        .rack {
            width: 150px; height: 120px; background: #5d4037;
            border: 4px solid #4a332a; display: grid;
            grid-template-rows: repeat(2, 1fr); gap: 5px; padding: 5px;
        }
        .shelf-row { border-bottom: 2px solid #4a332a; display: flex; justify-content: space-around; align-items: center; font-size: 25px; min-height: 40px; }

        .floor {
            position: absolute; bottom: 0; width: 100%; height: 30%;
            background: #5d4037; border-top: 8px solid #4a332a; z-index: 1;
        }

        .counter {
            position: absolute; bottom: 25%; width: 380px; height: 100px;
            background: #8b4513; border: 5px solid #5d4037; z-index: 10;
        }

        /* Characters */
        #player-sprite {
            position: absolute; bottom: 30%; width: 220px; 
            left: 50%; transform: translateX(-50%);
            z-index: 5; image-rendering: pixelated;
        }

        #customer-sprite {
            position: absolute; bottom: 18%; left: -300px; 
            width: 200px; z-index: 20; transition: left 1.5s linear;
            image-rendering: pixelated;
        }

        .cleaner-sprite {
            position: absolute; bottom: 15%; width: 140px; 
            z-index: 4; image-rendering: pixelated; 
            transition: left 1s linear; display: none;
        }

        .trash { position: absolute; font-size: 25px; cursor: pointer; z-index: 15; }

        /* UI & Modals */
        #ui-panel {
            width: 100%; height: 140px; background: #e1b382;
            border-top: 5px solid #5d4037; display: flex;
            justify-content: center; align-items: center; gap: 15px;
        }
        .stat-box { background: #5d4037; color: #f1c40f; padding: 10px; border-radius: 5px; font-weight: bold; }
        .game-btn { padding: 12px 18px; font-weight: bold; cursor: pointer; border: none; border-radius: 10px; color: white; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="shelf-container" id="shelves">
        <div class="rack"><div class="shelf-row"><span class="slot"></span><span class="slot"></span></div><div class="shelf-row"><span class="slot"></span><span class="slot"></span></div></div>
        <div class="rack"><div class="shelf-row"><span class="slot"></span><span class="slot"></span></div><div class="shelf-row"><span class="slot"></span><span class="slot"></span></div></div>
    </div>

    <div class="floor"></div>
    <img src="player.png" id="player-sprite"> <div class="counter"></div>
    <img src="ladycustomar.png" id="customer-sprite"> <img src="cleaner_idle.png" id="cleaner-obj" class="cleaner-sprite"> <button id="bill-btn" class="game-btn" style="position:absolute; bottom:42%; left:50%; transform:translateX(-50%); background:#f1c40f; color:black; display:none; z-index:150;" onclick="processBill()">SELL üßæ</button>
</div>

<div id="ui-panel">
    <div class="stat-box">üí∞ $<span id="cash">200</span></div>
    <div class="stat-box">üçÉ DIRT: <span id="dirt-count">0</span></div>
    <button class="game-btn" style="background: #27ae60;" onclick="buyStock()">BUY STOCK ($20)</button>
    <button id="hire-btn" class="game-btn" style="background: #3498db;" onclick="hireCleaner()">HIRE CLEANER ($150)</button>
</div>

<script>
    let cash = 200, dirt = 0, stock = 0, isWaiting = false, hasCleaner = false;
    let playerPos = 50;

    // --- PLAYER MOVEMENT ---
    window.addEventListener('keydown', (e) => {
        const player = document.getElementById('player-sprite');
        if (e.key === 'ArrowLeft' && playerPos > 30) playerPos -= 3;
        if (e.key === 'ArrowRight' && playerPos < 70) playerPos += 3;
        player.style.left = playerPos + "%";
    });

    // --- CLEANER LOGIC ---
    function hireCleaner() {
        if (cash >= 150 && !hasCleaner) {
            cash -= 150; hasCleaner = true;
            const cln = document.getElementById('cleaner-obj');
            cln.style.display = 'block';
            cln.style.left = "10%";
            document.getElementById('hire-btn').innerText = "CLEANER ACTIVE ‚úÖ";
            updateUI();

            setInterval(() => {
                let leaves = document.querySelectorAll('.trash');
                if (leaves.length > 0) {
                    let target = leaves[0];
                    let leafX = parseFloat(target.style.left);
                    let cleanerX = parseFloat(cln.style.left);

                    // Image change based on direction
                    cln.src = (leafX < cleanerX) ? "cleaner_walk_left.png" : "cleaner_walk_right.png";
                    cln.style.left = leafX + "%";

                    setTimeout(() => {
                        target.remove();
                        dirt--;
                        cln.src = "cleaner_idle.png";
                        updateUI();
                    }, 1000);
                }
            }, 4000);
        }
    }

    function buyStock() {
        if (cash >= 20) {
            cash -= 20; stock++;
            updateShelves(); updateUI();
        }
    }

    function updateShelves() {
        const slots = document.querySelectorAll('.slot');
        for(let i=0; i<stock && i<slots.length; i++) slots[i].innerText = "üçé";
    }

    function spawnCustomer() {
        if (isWaiting || dirt > 5) return;
        isWaiting = true;
        const cust = document.getElementById('customer-sprite');
        cust.style.left = "40%"; 
        setTimeout(() => {
            createLeaf();
            if (stock > 0) document.getElementById('bill-btn').style.display = "block";
            else setTimeout(customerLeave, 2000);
        }, 1500);
    }

    function createLeaf() {
        const leaf = document.createElement('div');
        leaf.className = 'trash';
        leaf.innerText = 'üçÉ';
        leaf.style.left = (Math.random() * 60 + 20) + "%";
        leaf.style.bottom = "5%";
        leaf.onclick = function() { this.remove(); dirt--; updateUI(); };
        document.getElementById('game-container').appendChild(leaf);
        dirt++; updateUI();
    }

    function processBill() {
        cash += 50; stock--;
        updateShelves(); updateUI();
        document.getElementById('bill-btn').style.display = "none";
        customerLeave();
    }

    function customerLeave() {
        const cust = document.getElementById('customer-sprite');
        cust.style.left = "110%";
        setTimeout(() => { 
            cust.style.transition="none"; cust.style.left="-300px"; 
            setTimeout(()=> {cust.style.transition="left 1.5s linear"; isWaiting=false;}, 50); 
        }, 1500);
    }

    function updateUI() {
        document.getElementById('cash').innerText = cash;
        document.getElementById('dirt-count').innerText = dirt;
    }

    setInterval(spawnCustomer, 7000);
</script>
</body>
</html>
